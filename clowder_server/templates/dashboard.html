{% extends "base.html" %}

{% block content %}

{% regroup pings by name as ping_names %}

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
</script>

<div class="container">
    <div class="row">
      <div class="col-md-6">

        <ul>
        {% for ping_name in ping_names %}
            <li>
                {{ ping_name.grouper }}<br>
                <b>Passing</b>
                <script type="text/javascript">
                  google.setOnLoadCallback(drawChart);
                  function drawChart() {
                    var data = google.visualization.arrayToDataTable([
                      ['Datetime', 'Value'],
                        {% for item in ping_name.list %}
                          [new Date("{{ item.create.isoformat }}"), {{ item.value }}]
                          {% if not forloop.last %},{% endif %}
                        {% endfor %}
                    ]);

                    var options = {
                      title: '{{ ping_name.grouper }}',
                      hAxis: {title: 'Year',  titleTextStyle: {color: '#333'}},
                      vAxis: {minValue: 0}
                    };

                    var chart = new google.visualization.AreaChart(document.getElementById('chart_div_{{forloop.counter}}'));
                    chart.draw(data, options);
                  }
                </script>

                <div id="chart_div_{{forloop.counter}}" style="width: 900px; height: 500px;"></div>
            </li>
        {% endfor %}
        </ul>

        <br><br><br><br><br><br><br><br>
        {% endblock %}

      </div>
    </div>
</div>
