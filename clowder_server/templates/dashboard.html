{% extends "base.html" %}

{% block content %}

{% regroup pings by name as ping_names %}

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
</script>

<div class="container">
    <div class="row">
      <div class="col-md-8">

        <ul>
        {% for ping_name in ping_names %}
            <li>
                {{ ping_name.grouper }}<br>
                <b>Passing</b> - {% with ping_name.list|last as last %}{{last.create.isoformat}}{% endwith %}
                <script type="text/javascript">
                  google.setOnLoadCallback(drawChart);
                  function drawChart() {
                    var data = google.visualization.arrayToDataTable([
                      ['Datetime', 'Value'],
                        {% for item in ping_name.list %}
                          [new Date("{{ item.create.isoformat }}"), {{ item.value }}]
                          {% if not forloop.last %},{% endif %}
                        {% endfor %}
                    ]);

                    var options = {
                      title: '{{ ping_name.grouper }}',
                      hAxis: {title: 'Year',  titleTextStyle: {color: '#333'}},
                      vAxis: {minValue: 0}
                    };

                    var chart = new google.visualization.AreaChart(document.getElementById('chart_div_{{forloop.counter}}'));
                    chart.draw(data, options);
                  }
                </script>

                <div id="chart_div_{{forloop.counter}}" style="width: 900px; height: 500px;"></div>
            </li>


        {% empty %}

            You can no alerts yet. Please refer to the documentation on how to get started.
            <br><br>

            API Key: <b>{{user.public_key}}</b><br><br>
            pip install https://github.com/keithhackbarth/clowder_python_client/archive/master.zip<br><br>

<pre><code>import clowder
import psutil

clowder.api_key = '{{user.public_key}}'

clowder.ok({
   'name': 'Memory Utilization',
   'value': psutil.phymem_usage().percent
})
</code></pre>


        {% endfor %}
        </ul>

        <br><br><br><br><br><br><br><br>
        {% endblock %}

      </div>
    </div>
</div>
